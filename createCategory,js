const AWS = require('aws-sdk')
const dynamodb = new AWS.DynamoDB()
const { v4: uuidv4 } = require('uuid');

module.exports.handler = async (event) => {
    console.log(event.arguments)
    const id = uuidv4()
    const name = event.arguments.name
    const isCreatedByUser = event.arguments.isCreatedByUser
    const userId = event.arguments.userId
    const createdAt = Date()
    const params = {
        Item: {
            "id": {
                S: id
            },
            "name": {
                S: name
            },
            "isCreatedByUser": {
                S: isCreatedByUser
            },
            "userId": {
                S: userId
            },
            "createdAt": {
                S: createdAt
            }
        },
        ReturnConsumedCapacity: "TOTAL",
        TableName: process.env.CATEGORY_TABLE_NAME
    }

    return dynamodb.putItem(params).promise()
        .then(data => {
            return {
                name,
                userId,
                isCreatedByUser
            }
        })
        .catch(err => {
            return {
                data: {
                },
                description: err || "internal server error",
                status: true

            }
        })
};